%% Autogenerated by ./scripts/fast_actions_gen

-module(linc_max_action_set).
-compile(export_all).

insert(Ins, undefined) -> Ins;
insert(Ins, Old) -> insert(Ins,Old,[]).

insert([], Old, New) -> rappend(New, Old);
insert([{_,N,_}|_]=In,Old,New) -> ?MODULE:N(In,Old,New);
insert([{N,_}|_]=In,Old,New) -> ?MODULE:N(In,Old,New);
insert([N|_]=In,Old,New) -> ?MODULE:N(In,Old,New).

rappend([], L) -> L;
rappend([H | T], L) -> rappend(T, [H | L]).

merge([A|Rest], Old, New) -> insert(Rest,Old,[A|New]).

copy_ttl_inwards(A,[copy_ttl_inwards|Old],New) -> merge(A, Old, New);
copy_ttl_inwards(A,Old,New) -> merge(A, Old, New).

pop_pbb(A,[copy_ttl_inwards=B|Old],New) -> pop_pbb(A, Old, [B|New]);
pop_pbb(A,[pop_pbb|Old],New) -> merge(A, Old, New);
pop_pbb(A,Old,New) -> merge(A, Old, New).

pop_mpls(A,[copy_ttl_inwards=B|Old],New) -> pop_mpls(A, Old, [B|New]);
pop_mpls(A,[pop_pbb=B|Old],New) -> pop_mpls(A, Old, [B|New]);
pop_mpls(A,[{pop_mpls,_}|Old],New) -> merge(A, Old, New);
pop_mpls(A,Old,New) -> merge(A, Old, New).

pop_vlan(A,[copy_ttl_inwards=B|Old],New) -> pop_vlan(A, Old, [B|New]);
pop_vlan(A,[pop_pbb=B|Old],New) -> pop_vlan(A, Old, [B|New]);
pop_vlan(A,[{pop_mpls,_}=B|Old],New) -> pop_vlan(A, Old, [B|New]);
pop_vlan(A,[pop_vlan|Old],New) -> merge(A, Old, New);
pop_vlan(A,Old,New) -> merge(A, Old, New).

push_mpls(A,[copy_ttl_inwards=B|Old],New) -> push_mpls(A, Old, [B|New]);
push_mpls(A,[pop_pbb=B|Old],New) -> push_mpls(A, Old, [B|New]);
push_mpls(A,[{pop_mpls,_}=B|Old],New) -> push_mpls(A, Old, [B|New]);
push_mpls(A,[pop_vlan=B|Old],New) -> push_mpls(A, Old, [B|New]);
push_mpls(A,[{push_mpls,_}|Old],New) -> merge(A, Old, New);
push_mpls(A,Old,New) -> merge(A, Old, New).

push_pbb(A,[copy_ttl_inwards=B|Old],New) -> push_pbb(A, Old, [B|New]);
push_pbb(A,[pop_pbb=B|Old],New) -> push_pbb(A, Old, [B|New]);
push_pbb(A,[{pop_mpls,_}=B|Old],New) -> push_pbb(A, Old, [B|New]);
push_pbb(A,[pop_vlan=B|Old],New) -> push_pbb(A, Old, [B|New]);
push_pbb(A,[{push_mpls,_}=B|Old],New) -> push_pbb(A, Old, [B|New]);
push_pbb(A,[{push_pbb,_}|Old],New) -> merge(A, Old, New);
push_pbb(A,Old,New) -> merge(A, Old, New).

push_vlan(A,[copy_ttl_inwards=B|Old],New) -> push_vlan(A, Old, [B|New]);
push_vlan(A,[pop_pbb=B|Old],New) -> push_vlan(A, Old, [B|New]);
push_vlan(A,[{pop_mpls,_}=B|Old],New) -> push_vlan(A, Old, [B|New]);
push_vlan(A,[pop_vlan=B|Old],New) -> push_vlan(A, Old, [B|New]);
push_vlan(A,[{push_mpls,_}=B|Old],New) -> push_vlan(A, Old, [B|New]);
push_vlan(A,[{push_pbb,_}=B|Old],New) -> push_vlan(A, Old, [B|New]);
push_vlan(A,[{push_vlan,_}|Old],New) -> merge(A, Old, New);
push_vlan(A,Old,New) -> merge(A, Old, New).

copy_ttl_outwards(A,[copy_ttl_inwards=B|Old],New) -> copy_ttl_outwards(A, Old, [B|New]);
copy_ttl_outwards(A,[pop_pbb=B|Old],New) -> copy_ttl_outwards(A, Old, [B|New]);
copy_ttl_outwards(A,[{pop_mpls,_}=B|Old],New) -> copy_ttl_outwards(A, Old, [B|New]);
copy_ttl_outwards(A,[pop_vlan=B|Old],New) -> copy_ttl_outwards(A, Old, [B|New]);
copy_ttl_outwards(A,[{push_mpls,_}=B|Old],New) -> copy_ttl_outwards(A, Old, [B|New]);
copy_ttl_outwards(A,[{push_pbb,_}=B|Old],New) -> copy_ttl_outwards(A, Old, [B|New]);
copy_ttl_outwards(A,[{push_vlan,_}=B|Old],New) -> copy_ttl_outwards(A, Old, [B|New]);
copy_ttl_outwards(A,[copy_ttl_outwards|Old],New) -> merge(A, Old, New);
copy_ttl_outwards(A,Old,New) -> merge(A, Old, New).

dec_nw_ttl(A,[copy_ttl_inwards=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[pop_pbb=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[{pop_mpls,_}=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[pop_vlan=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[{push_mpls,_}=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[{push_pbb,_}=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[{push_vlan,_}=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[copy_ttl_outwards=B|Old],New) -> dec_nw_ttl(A, Old, [B|New]);
dec_nw_ttl(A,[dec_nw_ttl|Old],New) -> merge(A, Old, New);
dec_nw_ttl(A,Old,New) -> merge(A, Old, New).

dec_mpls_ttl(A,[copy_ttl_inwards=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[pop_pbb=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[{pop_mpls,_}=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[pop_vlan=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[{push_mpls,_}=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[{push_pbb,_}=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[{push_vlan,_}=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[copy_ttl_outwards=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[dec_nw_ttl=B|Old],New) -> dec_mpls_ttl(A, Old, [B|New]);
dec_mpls_ttl(A,[dec_mpls_ttl|Old],New) -> merge(A, Old, New);
dec_mpls_ttl(A,Old,New) -> merge(A, Old, New).

set_nw_ttl(A,[copy_ttl_inwards=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[pop_pbb=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[{pop_mpls,_}=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[pop_vlan=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[{push_mpls,_}=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[{push_pbb,_}=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[{push_vlan,_}=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[copy_ttl_outwards=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[dec_nw_ttl=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[dec_mpls_ttl=B|Old],New) -> set_nw_ttl(A, Old, [B|New]);
set_nw_ttl(A,[{set_nw_ttl,_}|Old],New) -> merge(A, Old, New);
set_nw_ttl(A,Old,New) -> merge(A, Old, New).

set_mpls_ttl(A,[copy_ttl_inwards=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[pop_pbb=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[{pop_mpls,_}=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[pop_vlan=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[{push_mpls,_}=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[{push_pbb,_}=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[{push_vlan,_}=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[copy_ttl_outwards=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[dec_nw_ttl=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[dec_mpls_ttl=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[{set_nw_ttl,_}=B|Old],New) -> set_mpls_ttl(A, Old, [B|New]);
set_mpls_ttl(A,[{set_mpls_ttl,_}|Old],New) -> merge(A, Old, New);
set_mpls_ttl(A,Old,New) -> merge(A, Old, New).

eth_dst(A,[copy_ttl_inwards=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[pop_pbb=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[{pop_mpls,_}=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[pop_vlan=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[{push_mpls,_}=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[{push_pbb,_}=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[{push_vlan,_}=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[copy_ttl_outwards=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[dec_nw_ttl=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[dec_mpls_ttl=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[{set_nw_ttl,_}=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[{set_mpls_ttl,_}=B|Old],New) -> eth_dst(A, Old, [B|New]);
eth_dst(A,[{set_field,eth_dst,_}|Old],New) -> merge(A, Old, New);
eth_dst(A,Old,New) -> merge(A, Old, New).

eth_src(A,[copy_ttl_inwards=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[pop_pbb=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{pop_mpls,_}=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[pop_vlan=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{push_mpls,_}=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{push_pbb,_}=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{push_vlan,_}=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[copy_ttl_outwards=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[dec_nw_ttl=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[dec_mpls_ttl=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{set_nw_ttl,_}=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{set_mpls_ttl,_}=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{set_field,eth_dst,_}=B|Old],New) -> eth_src(A, Old, [B|New]);
eth_src(A,[{set_field,eth_src,_}|Old],New) -> merge(A, Old, New);
eth_src(A,Old,New) -> merge(A, Old, New).

eth_type(A,[copy_ttl_inwards=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[pop_pbb=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{pop_mpls,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[pop_vlan=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{push_mpls,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{push_pbb,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{push_vlan,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[copy_ttl_outwards=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[dec_nw_ttl=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[dec_mpls_ttl=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{set_nw_ttl,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{set_mpls_ttl,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{set_field,eth_dst,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{set_field,eth_src,_}=B|Old],New) -> eth_type(A, Old, [B|New]);
eth_type(A,[{set_field,eth_type,_}|Old],New) -> merge(A, Old, New);
eth_type(A,Old,New) -> merge(A, Old, New).

vlan_vid(A,[copy_ttl_inwards=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[pop_pbb=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{pop_mpls,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[pop_vlan=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{push_mpls,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{push_pbb,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{push_vlan,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[copy_ttl_outwards=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[dec_nw_ttl=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[dec_mpls_ttl=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{set_nw_ttl,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{set_mpls_ttl,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{set_field,eth_dst,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{set_field,eth_src,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{set_field,eth_type,_}=B|Old],New) -> vlan_vid(A, Old, [B|New]);
vlan_vid(A,[{set_field,vlan_vid,_}|Old],New) -> merge(A, Old, New);
vlan_vid(A,Old,New) -> merge(A, Old, New).

vlan_pcp(A,[copy_ttl_inwards=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[pop_pbb=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{pop_mpls,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[pop_vlan=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{push_mpls,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{push_pbb,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{push_vlan,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[copy_ttl_outwards=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[dec_nw_ttl=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[dec_mpls_ttl=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{set_nw_ttl,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{set_mpls_ttl,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{set_field,eth_dst,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{set_field,eth_src,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{set_field,eth_type,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{set_field,vlan_vid,_}=B|Old],New) -> vlan_pcp(A, Old, [B|New]);
vlan_pcp(A,[{set_field,vlan_pcp,_}|Old],New) -> merge(A, Old, New);
vlan_pcp(A,Old,New) -> merge(A, Old, New).

ip_dscp(A,[copy_ttl_inwards=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[pop_pbb=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{pop_mpls,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[pop_vlan=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{push_mpls,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{push_pbb,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{push_vlan,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[copy_ttl_outwards=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[dec_nw_ttl=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[dec_mpls_ttl=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_nw_ttl,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_mpls_ttl,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_field,eth_dst,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_field,eth_src,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_field,eth_type,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_field,vlan_vid,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ip_dscp(A, Old, [B|New]);
ip_dscp(A,[{set_field,ip_dscp,_}|Old],New) -> merge(A, Old, New);
ip_dscp(A,Old,New) -> merge(A, Old, New).

ip_ecn(A,[copy_ttl_inwards=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[pop_pbb=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{pop_mpls,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[pop_vlan=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{push_mpls,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{push_pbb,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{push_vlan,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[copy_ttl_outwards=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[dec_nw_ttl=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[dec_mpls_ttl=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_nw_ttl,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_mpls_ttl,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_field,eth_dst,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_field,eth_src,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_field,eth_type,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_field,vlan_vid,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_field,ip_dscp,_}=B|Old],New) -> ip_ecn(A, Old, [B|New]);
ip_ecn(A,[{set_field,ip_ecn,_}|Old],New) -> merge(A, Old, New);
ip_ecn(A,Old,New) -> merge(A, Old, New).

ip_proto(A,[copy_ttl_inwards=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[pop_pbb=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{pop_mpls,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[pop_vlan=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{push_mpls,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{push_pbb,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{push_vlan,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[copy_ttl_outwards=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[dec_nw_ttl=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[dec_mpls_ttl=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_nw_ttl,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_mpls_ttl,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,eth_dst,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,eth_src,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,eth_type,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,vlan_vid,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,ip_dscp,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,ip_ecn,_}=B|Old],New) -> ip_proto(A, Old, [B|New]);
ip_proto(A,[{set_field,ip_proto,_}|Old],New) -> merge(A, Old, New);
ip_proto(A,Old,New) -> merge(A, Old, New).

ipv4_src(A,[copy_ttl_inwards=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[pop_pbb=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{pop_mpls,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[pop_vlan=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{push_mpls,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{push_pbb,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{push_vlan,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[copy_ttl_outwards=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[dec_nw_ttl=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[dec_mpls_ttl=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_nw_ttl,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,eth_src,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,eth_type,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv4_src(A, Old, [B|New]);
ipv4_src(A,[{set_field,ipv4_src,_}|Old],New) -> merge(A, Old, New);
ipv4_src(A,Old,New) -> merge(A, Old, New).

ipv4_dst(A,[copy_ttl_inwards=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[pop_pbb=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{pop_mpls,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[pop_vlan=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{push_mpls,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{push_pbb,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{push_vlan,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[copy_ttl_outwards=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[dec_nw_ttl=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[dec_mpls_ttl=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_nw_ttl,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,eth_src,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,eth_type,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv4_dst(A, Old, [B|New]);
ipv4_dst(A,[{set_field,ipv4_dst,_}|Old],New) -> merge(A, Old, New);
ipv4_dst(A,Old,New) -> merge(A, Old, New).

tcp_src(A,[copy_ttl_inwards=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[pop_pbb=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{pop_mpls,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[pop_vlan=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{push_mpls,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{push_pbb,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{push_vlan,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[copy_ttl_outwards=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[dec_nw_ttl=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[dec_mpls_ttl=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_nw_ttl,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_mpls_ttl,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,eth_dst,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,eth_src,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,eth_type,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,vlan_vid,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,vlan_pcp,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,ip_dscp,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,ip_ecn,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,ip_proto,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,ipv4_src,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,ipv4_dst,_}=B|Old],New) -> tcp_src(A, Old, [B|New]);
tcp_src(A,[{set_field,tcp_src,_}|Old],New) -> merge(A, Old, New);
tcp_src(A,Old,New) -> merge(A, Old, New).

tcp_dst(A,[copy_ttl_inwards=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[pop_pbb=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{pop_mpls,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[pop_vlan=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{push_mpls,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{push_pbb,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{push_vlan,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[copy_ttl_outwards=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[dec_nw_ttl=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[dec_mpls_ttl=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_nw_ttl,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_mpls_ttl,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,eth_dst,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,eth_src,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,eth_type,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,vlan_vid,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,vlan_pcp,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,ip_dscp,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,ip_ecn,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,ip_proto,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,ipv4_src,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,ipv4_dst,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,tcp_src,_}=B|Old],New) -> tcp_dst(A, Old, [B|New]);
tcp_dst(A,[{set_field,tcp_dst,_}|Old],New) -> merge(A, Old, New);
tcp_dst(A,Old,New) -> merge(A, Old, New).

udp_src(A,[copy_ttl_inwards=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[pop_pbb=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{pop_mpls,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[pop_vlan=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{push_mpls,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{push_pbb,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{push_vlan,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[copy_ttl_outwards=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[dec_nw_ttl=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[dec_mpls_ttl=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_nw_ttl,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_mpls_ttl,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,eth_dst,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,eth_src,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,eth_type,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,vlan_vid,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,vlan_pcp,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,ip_dscp,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,ip_ecn,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,ip_proto,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,ipv4_src,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,ipv4_dst,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,tcp_src,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,tcp_dst,_}=B|Old],New) -> udp_src(A, Old, [B|New]);
udp_src(A,[{set_field,udp_src,_}|Old],New) -> merge(A, Old, New);
udp_src(A,Old,New) -> merge(A, Old, New).

udp_dst(A,[copy_ttl_inwards=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[pop_pbb=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{pop_mpls,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[pop_vlan=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{push_mpls,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{push_pbb,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{push_vlan,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[copy_ttl_outwards=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[dec_nw_ttl=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[dec_mpls_ttl=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_nw_ttl,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_mpls_ttl,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,eth_dst,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,eth_src,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,eth_type,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,vlan_vid,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,vlan_pcp,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,ip_dscp,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,ip_ecn,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,ip_proto,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,ipv4_src,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,ipv4_dst,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,tcp_src,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,tcp_dst,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,udp_src,_}=B|Old],New) -> udp_dst(A, Old, [B|New]);
udp_dst(A,[{set_field,udp_dst,_}|Old],New) -> merge(A, Old, New);
udp_dst(A,Old,New) -> merge(A, Old, New).

sctp_src(A,[copy_ttl_inwards=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[pop_pbb=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{pop_mpls,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[pop_vlan=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{push_mpls,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{push_pbb,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{push_vlan,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[copy_ttl_outwards=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[dec_nw_ttl=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[dec_mpls_ttl=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_nw_ttl,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_mpls_ttl,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,eth_dst,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,eth_src,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,eth_type,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,vlan_vid,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,vlan_pcp,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,ip_dscp,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,ip_ecn,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,ip_proto,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,ipv4_src,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,ipv4_dst,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,tcp_src,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,tcp_dst,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,udp_src,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,udp_dst,_}=B|Old],New) -> sctp_src(A, Old, [B|New]);
sctp_src(A,[{set_field,sctp_src,_}|Old],New) -> merge(A, Old, New);
sctp_src(A,Old,New) -> merge(A, Old, New).

sctp_dst(A,[copy_ttl_inwards=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[pop_pbb=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{pop_mpls,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[pop_vlan=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{push_mpls,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{push_pbb,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{push_vlan,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[copy_ttl_outwards=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[dec_nw_ttl=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[dec_mpls_ttl=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_nw_ttl,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_mpls_ttl,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,eth_dst,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,eth_src,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,eth_type,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,vlan_vid,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,vlan_pcp,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,ip_dscp,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,ip_ecn,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,ip_proto,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,ipv4_src,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,ipv4_dst,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,tcp_src,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,tcp_dst,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,udp_src,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,udp_dst,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,sctp_src,_}=B|Old],New) -> sctp_dst(A, Old, [B|New]);
sctp_dst(A,[{set_field,sctp_dst,_}|Old],New) -> merge(A, Old, New);
sctp_dst(A,Old,New) -> merge(A, Old, New).

icmpv4_type(A,[copy_ttl_inwards=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[pop_pbb=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{pop_mpls,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[pop_vlan=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{push_mpls,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{push_pbb,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{push_vlan,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[copy_ttl_outwards=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[dec_nw_ttl=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[dec_mpls_ttl=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_nw_ttl,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_mpls_ttl,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,eth_dst,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,eth_src,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,eth_type,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,vlan_vid,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,vlan_pcp,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,ip_dscp,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,ip_ecn,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,ip_proto,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,ipv4_src,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,ipv4_dst,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,tcp_src,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,tcp_dst,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,udp_src,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,udp_dst,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,sctp_src,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,sctp_dst,_}=B|Old],New) -> icmpv4_type(A, Old, [B|New]);
icmpv4_type(A,[{set_field,icmpv4_type,_}|Old],New) -> merge(A, Old, New);
icmpv4_type(A,Old,New) -> merge(A, Old, New).

icmpv4_code(A,[copy_ttl_inwards=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[pop_pbb=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{pop_mpls,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[pop_vlan=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{push_mpls,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{push_pbb,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{push_vlan,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[copy_ttl_outwards=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[dec_nw_ttl=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[dec_mpls_ttl=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_nw_ttl,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_mpls_ttl,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,eth_dst,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,eth_src,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,eth_type,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,vlan_vid,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,vlan_pcp,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,ip_dscp,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,ip_ecn,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,ip_proto,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,ipv4_src,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,ipv4_dst,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,tcp_src,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,tcp_dst,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,udp_src,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,udp_dst,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,sctp_src,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,sctp_dst,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,icmpv4_type,_}=B|Old],New) -> icmpv4_code(A, Old, [B|New]);
icmpv4_code(A,[{set_field,icmpv4_code,_}|Old],New) -> merge(A, Old, New);
icmpv4_code(A,Old,New) -> merge(A, Old, New).

arp_op(A,[copy_ttl_inwards=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[pop_pbb=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{pop_mpls,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[pop_vlan=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{push_mpls,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{push_pbb,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{push_vlan,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[copy_ttl_outwards=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[dec_nw_ttl=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[dec_mpls_ttl=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_nw_ttl,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_mpls_ttl,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,eth_dst,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,eth_src,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,eth_type,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,vlan_vid,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,vlan_pcp,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,ip_dscp,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,ip_ecn,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,ip_proto,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,ipv4_src,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,ipv4_dst,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,tcp_src,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,tcp_dst,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,udp_src,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,udp_dst,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,sctp_src,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,sctp_dst,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,icmpv4_type,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,icmpv4_code,_}=B|Old],New) -> arp_op(A, Old, [B|New]);
arp_op(A,[{set_field,arp_op,_}|Old],New) -> merge(A, Old, New);
arp_op(A,Old,New) -> merge(A, Old, New).

arp_spa(A,[copy_ttl_inwards=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[pop_pbb=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{pop_mpls,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[pop_vlan=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{push_mpls,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{push_pbb,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{push_vlan,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[copy_ttl_outwards=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[dec_nw_ttl=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[dec_mpls_ttl=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_nw_ttl,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_mpls_ttl,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,eth_dst,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,eth_src,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,eth_type,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,vlan_vid,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,vlan_pcp,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,ip_dscp,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,ip_ecn,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,ip_proto,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,ipv4_src,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,ipv4_dst,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,tcp_src,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,tcp_dst,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,udp_src,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,udp_dst,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,sctp_src,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,sctp_dst,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,icmpv4_type,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,icmpv4_code,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,arp_op,_}=B|Old],New) -> arp_spa(A, Old, [B|New]);
arp_spa(A,[{set_field,arp_spa,_}|Old],New) -> merge(A, Old, New);
arp_spa(A,Old,New) -> merge(A, Old, New).

arp_tpa(A,[copy_ttl_inwards=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[pop_pbb=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{pop_mpls,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[pop_vlan=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{push_mpls,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{push_pbb,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{push_vlan,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[copy_ttl_outwards=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[dec_nw_ttl=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[dec_mpls_ttl=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_nw_ttl,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_mpls_ttl,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,eth_dst,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,eth_src,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,eth_type,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,vlan_vid,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,vlan_pcp,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,ip_dscp,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,ip_ecn,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,ip_proto,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,ipv4_src,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,ipv4_dst,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,tcp_src,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,tcp_dst,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,udp_src,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,udp_dst,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,sctp_src,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,sctp_dst,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,icmpv4_type,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,icmpv4_code,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,arp_op,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,arp_spa,_}=B|Old],New) -> arp_tpa(A, Old, [B|New]);
arp_tpa(A,[{set_field,arp_tpa,_}|Old],New) -> merge(A, Old, New);
arp_tpa(A,Old,New) -> merge(A, Old, New).

arp_sha(A,[copy_ttl_inwards=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[pop_pbb=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{pop_mpls,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[pop_vlan=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{push_mpls,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{push_pbb,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{push_vlan,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[copy_ttl_outwards=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[dec_nw_ttl=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[dec_mpls_ttl=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_nw_ttl,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_mpls_ttl,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,eth_dst,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,eth_src,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,eth_type,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,vlan_vid,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,vlan_pcp,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,ip_dscp,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,ip_ecn,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,ip_proto,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,ipv4_src,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,ipv4_dst,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,tcp_src,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,tcp_dst,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,udp_src,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,udp_dst,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,sctp_src,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,sctp_dst,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,icmpv4_type,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,icmpv4_code,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,arp_op,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,arp_spa,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,arp_tpa,_}=B|Old],New) -> arp_sha(A, Old, [B|New]);
arp_sha(A,[{set_field,arp_sha,_}|Old],New) -> merge(A, Old, New);
arp_sha(A,Old,New) -> merge(A, Old, New).

arp_tha(A,[copy_ttl_inwards=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[pop_pbb=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{pop_mpls,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[pop_vlan=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{push_mpls,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{push_pbb,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{push_vlan,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[copy_ttl_outwards=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[dec_nw_ttl=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[dec_mpls_ttl=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_nw_ttl,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_mpls_ttl,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,eth_dst,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,eth_src,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,eth_type,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,vlan_vid,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,vlan_pcp,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,ip_dscp,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,ip_ecn,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,ip_proto,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,ipv4_src,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,ipv4_dst,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,tcp_src,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,tcp_dst,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,udp_src,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,udp_dst,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,sctp_src,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,sctp_dst,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,icmpv4_type,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,icmpv4_code,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,arp_op,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,arp_spa,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,arp_tpa,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,arp_sha,_}=B|Old],New) -> arp_tha(A, Old, [B|New]);
arp_tha(A,[{set_field,arp_tha,_}|Old],New) -> merge(A, Old, New);
arp_tha(A,Old,New) -> merge(A, Old, New).

ipv6_src(A,[copy_ttl_inwards=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[pop_pbb=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{pop_mpls,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[pop_vlan=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{push_mpls,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{push_pbb,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{push_vlan,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[copy_ttl_outwards=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[dec_nw_ttl=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[dec_mpls_ttl=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_nw_ttl,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,eth_src,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,eth_type,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,ipv4_dst,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,tcp_src,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,tcp_dst,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,udp_src,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,udp_dst,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,sctp_src,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,sctp_dst,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,icmpv4_type,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,icmpv4_code,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,arp_op,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,arp_spa,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,arp_tpa,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,arp_sha,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,arp_tha,_}=B|Old],New) -> ipv6_src(A, Old, [B|New]);
ipv6_src(A,[{set_field,ipv6_src,_}|Old],New) -> merge(A, Old, New);
ipv6_src(A,Old,New) -> merge(A, Old, New).

ipv6_dst(A,[copy_ttl_inwards=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[pop_pbb=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{pop_mpls,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[pop_vlan=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{push_mpls,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{push_pbb,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{push_vlan,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[copy_ttl_outwards=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[dec_nw_ttl=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[dec_mpls_ttl=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_nw_ttl,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,eth_src,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,eth_type,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,ipv4_dst,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,tcp_src,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,tcp_dst,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,udp_src,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,udp_dst,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,sctp_src,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,sctp_dst,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,icmpv4_type,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,icmpv4_code,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,arp_op,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,arp_spa,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,arp_tpa,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,arp_sha,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,arp_tha,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,ipv6_src,_}=B|Old],New) -> ipv6_dst(A, Old, [B|New]);
ipv6_dst(A,[{set_field,ipv6_dst,_}|Old],New) -> merge(A, Old, New);
ipv6_dst(A,Old,New) -> merge(A, Old, New).

ipv6_label(A,[copy_ttl_inwards=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[pop_pbb=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{pop_mpls,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[pop_vlan=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{push_mpls,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{push_pbb,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{push_vlan,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[copy_ttl_outwards=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[dec_nw_ttl=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[dec_mpls_ttl=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_nw_ttl,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,eth_src,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,eth_type,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ipv4_dst,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,tcp_src,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,tcp_dst,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,udp_src,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,udp_dst,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,sctp_src,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,sctp_dst,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,icmpv4_type,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,icmpv4_code,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,arp_op,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,arp_spa,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,arp_tpa,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,arp_sha,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,arp_tha,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ipv6_src,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ipv6_dst,_}=B|Old],New) -> ipv6_label(A, Old, [B|New]);
ipv6_label(A,[{set_field,ipv6_label,_}|Old],New) -> merge(A, Old, New);
ipv6_label(A,Old,New) -> merge(A, Old, New).

icmpv6_type(A,[copy_ttl_inwards=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[pop_pbb=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{pop_mpls,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[pop_vlan=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{push_mpls,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{push_pbb,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{push_vlan,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[copy_ttl_outwards=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[dec_nw_ttl=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[dec_mpls_ttl=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_nw_ttl,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_mpls_ttl,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,eth_dst,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,eth_src,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,eth_type,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,vlan_vid,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,vlan_pcp,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ip_dscp,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ip_ecn,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ip_proto,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ipv4_src,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ipv4_dst,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,tcp_src,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,tcp_dst,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,udp_src,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,udp_dst,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,sctp_src,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,sctp_dst,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,icmpv4_type,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,icmpv4_code,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,arp_op,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,arp_spa,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,arp_tpa,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,arp_sha,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,arp_tha,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ipv6_src,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ipv6_dst,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,ipv6_label,_}=B|Old],New) -> icmpv6_type(A, Old, [B|New]);
icmpv6_type(A,[{set_field,icmpv6_type,_}|Old],New) -> merge(A, Old, New);
icmpv6_type(A,Old,New) -> merge(A, Old, New).

icmpv6_code(A,[copy_ttl_inwards=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[pop_pbb=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{pop_mpls,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[pop_vlan=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{push_mpls,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{push_pbb,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{push_vlan,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[copy_ttl_outwards=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[dec_nw_ttl=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[dec_mpls_ttl=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_nw_ttl,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_mpls_ttl,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,eth_dst,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,eth_src,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,eth_type,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,vlan_vid,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,vlan_pcp,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ip_dscp,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ip_ecn,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ip_proto,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ipv4_src,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ipv4_dst,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,tcp_src,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,tcp_dst,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,udp_src,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,udp_dst,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,sctp_src,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,sctp_dst,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,icmpv4_type,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,icmpv4_code,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,arp_op,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,arp_spa,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,arp_tpa,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,arp_sha,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,arp_tha,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ipv6_src,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ipv6_dst,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,ipv6_label,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,icmpv6_type,_}=B|Old],New) -> icmpv6_code(A, Old, [B|New]);
icmpv6_code(A,[{set_field,icmpv6_code,_}|Old],New) -> merge(A, Old, New);
icmpv6_code(A,Old,New) -> merge(A, Old, New).

ipv6_nd_target(A,[copy_ttl_inwards=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[pop_pbb=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{pop_mpls,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[pop_vlan=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{push_mpls,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{push_pbb,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{push_vlan,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[copy_ttl_outwards=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[dec_nw_ttl=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[dec_mpls_ttl=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_nw_ttl,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,eth_src,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,eth_type,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ipv4_dst,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,tcp_src,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,tcp_dst,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,udp_src,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,udp_dst,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,sctp_src,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,sctp_dst,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,icmpv4_type,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,icmpv4_code,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,arp_op,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,arp_spa,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,arp_tpa,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,arp_sha,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,arp_tha,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ipv6_src,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ipv6_dst,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ipv6_label,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,icmpv6_type,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,icmpv6_code,_}=B|Old],New) -> ipv6_nd_target(A, Old, [B|New]);
ipv6_nd_target(A,[{set_field,ipv6_nd_target,_}|Old],New) -> merge(A, Old, New);
ipv6_nd_target(A,Old,New) -> merge(A, Old, New).

ipv6_nd_sll(A,[copy_ttl_inwards=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[pop_pbb=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{pop_mpls,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[pop_vlan=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{push_mpls,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{push_pbb,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{push_vlan,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[copy_ttl_outwards=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[dec_nw_ttl=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[dec_mpls_ttl=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_nw_ttl,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,eth_src,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,eth_type,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ipv4_dst,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,tcp_src,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,tcp_dst,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,udp_src,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,udp_dst,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,sctp_src,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,sctp_dst,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,icmpv4_type,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,icmpv4_code,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,arp_op,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,arp_spa,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,arp_tpa,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,arp_sha,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,arp_tha,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ipv6_src,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ipv6_dst,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ipv6_label,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,icmpv6_type,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,icmpv6_code,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> ipv6_nd_sll(A, Old, [B|New]);
ipv6_nd_sll(A,[{set_field,ipv6_nd_sll,_}|Old],New) -> merge(A, Old, New);
ipv6_nd_sll(A,Old,New) -> merge(A, Old, New).

ipv6_nd_tll(A,[copy_ttl_inwards=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[pop_pbb=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{pop_mpls,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[pop_vlan=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{push_mpls,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{push_pbb,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{push_vlan,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[copy_ttl_outwards=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[dec_nw_ttl=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[dec_mpls_ttl=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_nw_ttl,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,eth_src,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,eth_type,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv4_dst,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,tcp_src,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,tcp_dst,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,udp_src,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,udp_dst,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,sctp_src,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,sctp_dst,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,icmpv4_type,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,icmpv4_code,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,arp_op,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,arp_spa,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,arp_tpa,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,arp_sha,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,arp_tha,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv6_src,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv6_dst,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv6_label,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,icmpv6_type,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,icmpv6_code,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv6_nd_sll,_}=B|Old],New) -> ipv6_nd_tll(A, Old, [B|New]);
ipv6_nd_tll(A,[{set_field,ipv6_nd_tll,_}|Old],New) -> merge(A, Old, New);
ipv6_nd_tll(A,Old,New) -> merge(A, Old, New).

mpls_label(A,[copy_ttl_inwards=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[pop_pbb=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{pop_mpls,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[pop_vlan=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{push_mpls,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{push_pbb,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{push_vlan,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[copy_ttl_outwards=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[dec_nw_ttl=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[dec_mpls_ttl=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_nw_ttl,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_mpls_ttl,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,eth_dst,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,eth_src,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,eth_type,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,vlan_vid,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,vlan_pcp,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ip_dscp,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ip_ecn,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ip_proto,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv4_src,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv4_dst,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,tcp_src,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,tcp_dst,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,udp_src,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,udp_dst,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,sctp_src,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,sctp_dst,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,icmpv4_type,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,icmpv4_code,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,arp_op,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,arp_spa,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,arp_tpa,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,arp_sha,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,arp_tha,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv6_src,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv6_dst,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv6_label,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,icmpv6_type,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,icmpv6_code,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv6_nd_sll,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,ipv6_nd_tll,_}=B|Old],New) -> mpls_label(A, Old, [B|New]);
mpls_label(A,[{set_field,mpls_label,_}|Old],New) -> merge(A, Old, New);
mpls_label(A,Old,New) -> merge(A, Old, New).

mpls_tc(A,[copy_ttl_inwards=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[pop_pbb=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{pop_mpls,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[pop_vlan=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{push_mpls,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{push_pbb,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{push_vlan,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[copy_ttl_outwards=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[dec_nw_ttl=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[dec_mpls_ttl=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_nw_ttl,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_mpls_ttl,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,eth_dst,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,eth_src,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,eth_type,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,vlan_vid,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,vlan_pcp,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ip_dscp,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ip_ecn,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ip_proto,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv4_src,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv4_dst,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,tcp_src,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,tcp_dst,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,udp_src,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,udp_dst,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,sctp_src,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,sctp_dst,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,icmpv4_type,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,icmpv4_code,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,arp_op,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,arp_spa,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,arp_tpa,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,arp_sha,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,arp_tha,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv6_src,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv6_dst,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv6_label,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,icmpv6_type,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,icmpv6_code,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv6_nd_sll,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,ipv6_nd_tll,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,mpls_label,_}=B|Old],New) -> mpls_tc(A, Old, [B|New]);
mpls_tc(A,[{set_field,mpls_tc,_}|Old],New) -> merge(A, Old, New);
mpls_tc(A,Old,New) -> merge(A, Old, New).

mpls_bos(A,[copy_ttl_inwards=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[pop_pbb=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{pop_mpls,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[pop_vlan=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{push_mpls,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{push_pbb,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{push_vlan,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[copy_ttl_outwards=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[dec_nw_ttl=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[dec_mpls_ttl=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_nw_ttl,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_mpls_ttl,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,eth_dst,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,eth_src,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,eth_type,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,vlan_vid,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,vlan_pcp,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ip_dscp,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ip_ecn,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ip_proto,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv4_src,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv4_dst,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,tcp_src,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,tcp_dst,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,udp_src,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,udp_dst,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,sctp_src,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,sctp_dst,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,icmpv4_type,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,icmpv4_code,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,arp_op,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,arp_spa,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,arp_tpa,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,arp_sha,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,arp_tha,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv6_src,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv6_dst,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv6_label,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,icmpv6_type,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,icmpv6_code,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv6_nd_sll,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,ipv6_nd_tll,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,mpls_label,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,mpls_tc,_}=B|Old],New) -> mpls_bos(A, Old, [B|New]);
mpls_bos(A,[{set_field,mpls_bos,_}|Old],New) -> merge(A, Old, New);
mpls_bos(A,Old,New) -> merge(A, Old, New).

pbb_isid(A,[copy_ttl_inwards=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[pop_pbb=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{pop_mpls,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[pop_vlan=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{push_mpls,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{push_pbb,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{push_vlan,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[copy_ttl_outwards=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[dec_nw_ttl=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[dec_mpls_ttl=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_nw_ttl,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_mpls_ttl,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,eth_dst,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,eth_src,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,eth_type,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,vlan_vid,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,vlan_pcp,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ip_dscp,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ip_ecn,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ip_proto,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv4_src,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv4_dst,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,tcp_src,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,tcp_dst,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,udp_src,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,udp_dst,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,sctp_src,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,sctp_dst,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,icmpv4_type,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,icmpv4_code,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,arp_op,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,arp_spa,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,arp_tpa,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,arp_sha,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,arp_tha,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv6_src,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv6_dst,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv6_label,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,icmpv6_type,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,icmpv6_code,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv6_nd_sll,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,ipv6_nd_tll,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,mpls_label,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,mpls_tc,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,mpls_bos,_}=B|Old],New) -> pbb_isid(A, Old, [B|New]);
pbb_isid(A,[{set_field,pbb_isid,_}|Old],New) -> merge(A, Old, New);
pbb_isid(A,Old,New) -> merge(A, Old, New).

tunnel_id(A,[copy_ttl_inwards=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[pop_pbb=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{pop_mpls,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[pop_vlan=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{push_mpls,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{push_pbb,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{push_vlan,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[copy_ttl_outwards=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[dec_nw_ttl=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[dec_mpls_ttl=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_nw_ttl,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_mpls_ttl,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,eth_dst,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,eth_src,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,eth_type,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,vlan_vid,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,vlan_pcp,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ip_dscp,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ip_ecn,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ip_proto,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv4_src,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv4_dst,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,tcp_src,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,tcp_dst,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,udp_src,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,udp_dst,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,sctp_src,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,sctp_dst,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,icmpv4_type,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,icmpv4_code,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,arp_op,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,arp_spa,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,arp_tpa,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,arp_sha,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,arp_tha,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv6_src,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv6_dst,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv6_label,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,icmpv6_type,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,icmpv6_code,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv6_nd_sll,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,ipv6_nd_tll,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,mpls_label,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,mpls_tc,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,mpls_bos,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,pbb_isid,_}=B|Old],New) -> tunnel_id(A, Old, [B|New]);
tunnel_id(A,[{set_field,tunnel_id,_}|Old],New) -> merge(A, Old, New);
tunnel_id(A,Old,New) -> merge(A, Old, New).

ipv6_exthdr(A,[copy_ttl_inwards=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[pop_pbb=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{pop_mpls,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[pop_vlan=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{push_mpls,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{push_pbb,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{push_vlan,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[copy_ttl_outwards=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[dec_nw_ttl=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[dec_mpls_ttl=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_nw_ttl,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_mpls_ttl,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,eth_dst,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,eth_src,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,eth_type,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,vlan_vid,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,vlan_pcp,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ip_dscp,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ip_ecn,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ip_proto,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv4_src,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv4_dst,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,tcp_src,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,tcp_dst,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,udp_src,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,udp_dst,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,sctp_src,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,sctp_dst,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,icmpv4_type,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,icmpv4_code,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,arp_op,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,arp_spa,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,arp_tpa,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,arp_sha,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,arp_tha,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv6_src,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv6_dst,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv6_label,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,icmpv6_type,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,icmpv6_code,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv6_nd_target,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv6_nd_sll,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv6_nd_tll,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,mpls_label,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,mpls_tc,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,mpls_bos,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,pbb_isid,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,tunnel_id,_}=B|Old],New) -> ipv6_exthdr(A, Old, [B|New]);
ipv6_exthdr(A,[{set_field,ipv6_exthdr,_}|Old],New) -> merge(A, Old, New);
ipv6_exthdr(A,Old,New) -> merge(A, Old, New).

